<UserControl x:Class="CheckoutApp.View.TransactionV"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:CheckoutApp.View"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewmodel="clr-namespace:CheckoutApp.ViewModel"
             d:DataContext="{d:DesignInstance Type=viewmodel:TransactionVM}"
             d:DesignHeight="450"
             d:DesignWidth="800"
             Background="White"
             mc:Ignorable="d">
    <materialDesign:DialogHost CloseOnClickAway="True" IsOpen="{Binding IsDialogOpen}">
        <materialDesign:DialogHost.DialogContent>
            <StackPanel MinWidth="220" Margin="20">
                <TextBlock Margin="10"
                           FontSize="14"
                           FontWeight="Bold"
                           Text="{Binding DialogTitle}" />
                <TextBox Width="220"
                         Margin="10"
                         materialDesign:HintAssist.Hint="{Binding DialogHint}"
                         FontSize="14"
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Text="{Binding DialogInputText, UpdateSourceTrigger=PropertyChanged}" />
                <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                    <Button Margin="5"
                            Background="Red"
                            Command="{Binding CancelDialogCommand}"
                            Content="Annuler"
                            Foreground="White"
                            Style="{StaticResource MaterialDesignOutlinedButton}" />
                    <Button Margin="5"
                            Background="Green"
                            Command="{Binding ConfirmDialogCommand}"
                            Content="Confirmer"
                            Foreground="White"
                            Style="{StaticResource MaterialDesignRaisedButton}" />
                </StackPanel>
            </StackPanel>
        </materialDesign:DialogHost.DialogContent>
        <materialDesign:Card Margin="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto" />
                    <RowDefinition Height="2*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="auto" />
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0"
                            Grid.Column="0"
                            HorizontalAlignment="Left"
                            Orientation="Horizontal">
                    <Button Margin="5"
                            HorizontalAlignment="Left"
                            Background="{DynamicResource PrimaryHueMidBrush}"
                            Content="Déconnexion"
                            Foreground="Black"
                            Style="{StaticResource MaterialDesignRaisedButton}" />
                    <Label HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Content="Utilisateur"
                           FontSize="16"
                           FontWeight="Bold" />
                </StackPanel>
                <!--  Menu du haut  -->
                <Label Grid.Row="0"
                       Grid.Column="1"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Content="Transaction en cours"
                       FontSize="16"
                       FontWeight="Bold" />

                <!--  Section des actions de transaction  -->
                <GroupBox Grid.Row="1"
                          Grid.Column="0"
                          Margin="5"
                          Style="{StaticResource MaterialDesignCardGroupBox}">
                    <GroupBox.Header>
                        <Border Background="{DynamicResource PrimaryHueMidBrush}" CornerRadius="5">
                            <TextBlock FontSize="14"
                                       FontWeight="Bold"
                                       Foreground="White"
                                       Text="Actions" />
                        </Border>
                    </GroupBox.Header>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <!--  Rangée 1  -->
                        <Button Grid.Row="0"
                                Grid.Column="0"
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Click="DiscountButton_Click"
                                Foreground="Black"
                                Style="{StaticResource MaterialDesignRaisedButton}">
                            <TextBlock FontSize="12"
                                       Text="Rabais employé"
                                       TextAlignment="Center"
                                       TextWrapping="Wrap" />
                        </Button>

                        <Button Grid.Row="0"
                                Grid.Column="1"
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Click="SearchProductButton_Click"
                                Foreground="Black"
                                Style="{StaticResource MaterialDesignRaisedButton}">
                            <TextBlock FontSize="12"
                                       Text="Recherche de produit"
                                       TextAlignment="Center"
                                       TextWrapping="Wrap" />
                        </Button>

                        <!--  Rangée 2  -->
                        <Button Grid.Row="1"
                                Grid.Column="0"
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Foreground="Black"
                                Style="{StaticResource MaterialDesignRaisedButton}">
                            <TextBlock FontSize="12"
                                       Text="Réimprimer la facture"
                                       TextAlignment="Center"
                                       TextWrapping="Wrap" />
                        </Button>

                        <Button Grid.Row="1"
                                Grid.Column="1"
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Command="{Binding OpenQuantityDialogCommand}"
                                Foreground="Black"
                                Style="{StaticResource MaterialDesignRaisedButton}">
                            <TextBlock FontSize="12"
                                       Text="Modifier la quantité"
                                       TextAlignment="Center"
                                       TextWrapping="Wrap" />
                        </Button>


                        <!--  Rangée 3  -->
                        <Button Grid.Row="2"
                                Grid.Column="0"
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Command="{Binding OpenCommentDialogCommand}"
                                Foreground="Black"
                                Style="{StaticResource MaterialDesignRaisedButton}">
                            <TextBlock FontSize="12"
                                       Text="Ajouter un commentaire"
                                       TextAlignment="Center"
                                       TextWrapping="Wrap" />
                        </Button>

                        <Button Grid.Row="2"
                                Grid.Column="1"
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Command="{Binding RemoveFromTransactionCommand}"
                                Foreground="Black"
                                Style="{StaticResource MaterialDesignRaisedButton}">
                            <TextBlock FontSize="12"
                                       Text="Retirer un produit"
                                       TextAlignment="Center"
                                       TextWrapping="Wrap" />
                        </Button>
                    </Grid>
                </GroupBox>

                <!--  Panneau de produits de la transaction  -->
                <!--  Liste des produits  -->
                <Border Grid.Row="1"
                        Grid.Column="1"
                        Margin="5"
                        BorderBrush="#DDDDDD"
                        BorderThickness="1"
                        CornerRadius="5">
                    <DockPanel>
                        <!--  En-tête de la liste  -->
                        <Border Padding="8,6"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                CornerRadius="4,4,0,0"
                                DockPanel.Dock="Top">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0"
                                           FontSize="12"
                                           FontWeight="Bold"
                                           Text="Produit" />
                                <TextBlock Grid.Column="1"
                                           HorizontalAlignment="Center"
                                           FontSize="12"
                                           FontWeight="Bold"
                                           Text="Qté" />
                                <TextBlock Grid.Column="2"
                                           HorizontalAlignment="Center"
                                           FontSize="12"
                                           FontWeight="Bold"
                                           Text="Prix unit." />
                                <TextBlock Grid.Column="3"
                                           HorizontalAlignment="Right"
                                           FontSize="12"
                                           FontWeight="Bold"
                                           Text="Total" />
                            </Grid>
                        </Border>

                        <!--  Lignes de produits  -->
                        <ListBox BorderThickness="0"
                                 DockPanel.Dock="Top"
                                 ItemsSource="{Binding TransactionItems}"
                                 SelectedItem="{Binding SelectedTransactionItem}">
                            <ListBox.ItemContainerStyle>
                                <Style BasedOn="{StaticResource {x:Type ListBoxItem}}" TargetType="ListBoxItem">
                                    <Setter Property="Padding" Value="8,5" />
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                </Style>
                            </ListBox.ItemContainerStyle>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0"
                                                   VerticalAlignment="Center"
                                                   FontSize="13"
                                                   Text="{Binding ProductName}" />
                                        <TextBlock Grid.Column="1"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontSize="13"
                                                   Text="{Binding Quantity}" />
                                        <TextBlock Grid.Column="2"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontSize="13"
                                                   Text="{Binding UnitPrice, StringFormat={}{0:C2}}" />
                                        <TextBlock Grid.Column="3"
                                                   HorizontalAlignment="Right"
                                                   VerticalAlignment="Center"
                                                   FontSize="13"
                                                   FontWeight="SemiBold"
                                                   Text="{Binding TotalPrice, StringFormat={}{0:C2}}" />
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </DockPanel>
                </Border>

                <!--  Totaux de la transaction  -->
                <Border Grid.Row="2"
                        Grid.Column="1"
                        Margin="5"
                        Padding="12,8"
                        BorderBrush="#DDDDDD"
                        BorderThickness="1"
                        CornerRadius="5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="4" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0"
                                   Grid.Column="0"
                                   Margin="0,2"
                                   Foreground="#555555"
                                   Text="Sous-total" />
                        <TextBlock Grid.Row="0"
                                   Grid.Column="1"
                                   Margin="0,2"
                                   HorizontalAlignment="Right"
                                   Foreground="#555555"
                                   Text="{Binding Subtotal, StringFormat={}{0:C2}}" />

                        <TextBlock Grid.Row="1"
                                   Grid.Column="0"
                                   Margin="0,2"
                                   Foreground="#555555"
                                   Text="TPS" />
                        <TextBlock Grid.Row="1"
                                   Grid.Column="1"
                                   Margin="0,2"
                                   HorizontalAlignment="Right"
                                   Foreground="#555555"
                                   Text="{Binding Tps, StringFormat={}{0:C2}}" />

                        <TextBlock Grid.Row="2"
                                   Grid.Column="0"
                                   Margin="0,2"
                                   Foreground="#555555"
                                   Text="TVQ" />
                        <TextBlock Grid.Row="2"
                                   Grid.Column="1"
                                   Margin="0,2"
                                   HorizontalAlignment="Right"
                                   Foreground="#555555"
                                   Text="{Binding Tvq, StringFormat={}{0:C2}}" />

                        <!--  Ligne de séparation pour le total  -->
                        <Separator Grid.Row="3"
                                   Grid.ColumnSpan="2"
                                   Margin="0,5"
                                   Background="#DDDDDD" />

                        <TextBlock Grid.Row="4"
                                   Grid.Column="0"
                                   FontSize="15"
                                   FontWeight="Bold"
                                   Text="Total" />
                        <TextBlock Grid.Row="4"
                                   Grid.Column="1"
                                   HorizontalAlignment="Right"
                                   FontSize="15"
                                   FontWeight="Bold"
                                   Text="{Binding TransactionTotal, StringFormat={}{0:C2}}" />
                    </Grid>
                </Border>


                <!--  Section pour finaliser la transaction  -->
                <Grid Grid.Row="3" Grid.Column="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!--  Bouton annuler la transaction  -->
                    <Button Grid.Column="0"
                            Margin="5"
                            HorizontalAlignment="Left"
                            Background="Red"
                            Foreground="White"
                            Style="{StaticResource MaterialDesignRaisedButton}">
                        <TextBlock Text="Annuler"
                                   TextAlignment="Center"
                                   TextWrapping="Wrap" />
                    </Button>

                    <!--  Bouton passer au paiement  -->
                    <Button Grid.Column="1"
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            Background="Green"
                            Foreground="White"
                            Style="{StaticResource MaterialDesignRaisedButton}">
                        <TextBlock Text="Passer au paiement"
                                   TextAlignment="Center"
                                   TextWrapping="Wrap" />
                    </Button>
                </Grid>
            </Grid>
        </materialDesign:Card>
    </materialDesign:DialogHost>

</UserControl>
